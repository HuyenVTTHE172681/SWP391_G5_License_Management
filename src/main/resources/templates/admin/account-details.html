<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Admin • Account detail</title>
    <style>
        :root{
            --bg:#f5f7fb; --card:#ffffff; --muted:#64748b; --text:#0f172a; --border:#e2e8f0;
            --accent:#2563eb; --accent-2:#16a34a; --warn:#dc2626; --hover:#f1f5f9;
        }
        *{box-sizing:border-box}
        body{
            margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
            background:
                    radial-gradient(1200px 600px at 20% -10%, #c7d2fe33, transparent 60%),
                    radial-gradient(1000px 500px at 110% 10%, #bbf7d033, transparent 60%),
                    var(--bg);
            color:var(--text);
            padding:28px;
        }
        .wrap{max-width:1000px;margin:0 auto}
        .breadcrumb{margin:0 0 12px}
        .breadcrumb a{color:#334155;text-decoration:none}
        .breadcrumb a:hover{text-decoration:underline}
        .page-head{display:flex;justify-content:space-between;align-items:flex-end;gap:16px;margin-bottom:18px}
        .title{margin:0;font-weight:800;letter-spacing:.2px;line-height:1.1;font-size:clamp(24px,3vw,30px)}
        .subtitle{margin:6px 0 0;color:var(--muted);font-size:13px}

        .grid{display:grid;grid-template-columns: 1.1fr .9fr;gap:16px}
        @media (max-width:860px){ .grid{grid-template-columns:1fr} }

        .card{
            background: linear-gradient(180deg,#ffffff,#fbfdff);
            border:1px solid var(--border); border-radius:14px; box-shadow:0 10px 24px rgba(2,6,23,.08);
            overflow:hidden;
        }
        .card-head{padding:14px 16px;border-bottom:1px solid var(--border)}
        .card-title{margin:0;font-weight:700;font-size:15px}
        .card-body{padding:16px}

        /* Definition list (2 cột gọn gàng) */
        .dl{display:grid;grid-template-columns:160px 1fr;gap:8px 14px}
        .dl dt{font-weight:700;color:#0b1220}
        .dl dd{margin:0 0 8px 0}
        .muted{color:var(--muted)}
        .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace}

        /* Badges */
        .badge{display:inline-block;padding:3px 8px;border-radius:999px;font-size:12px;border:1px solid #c7d2fe;background:#eef2ff;color:#1e3a8a}
        .badge.status-active{background:#ecfdf5;color:#166534;border-color:#86efac}
        .badge.status-deactivated{background:#fee2e2;color:#991b1b;border-color:#fecaca}
        .badge.verify{background:#e0f2fe;border-color:#bae6fd;color:#075985}

        /* Forms & buttons */
        .form-row{display:flex;gap:8px;flex-wrap:wrap}
        select, input, button{font:inherit}
        select{
            background:#fff;border:1px solid var(--border);border-radius:8px;padding:8px 10px;min-width:160px
        }
        .btn{
            appearance:none;border:1px solid var(--border);background:#f8fafc;color:var(--text);
            padding:9px 12px;border-radius:10px;cursor:pointer;text-decoration:none;font-size:13px;
            transition:transform .05s ease, background .15s ease
        }
        .btn:hover{background:#eef2ff;transform:translateY(-1px)}
        .btn.primary{border-color:#bfdbfe;background:#eff6ff;color:#1e40af}
        .btn.success{border-color:#86efac;background:#ecfdf5;color:#166534}
        .btn.danger{border-color:#fecaca;background:#fff1f2;color:#9f1239}
        .btn.block{width:100%;text-align:center}
        .btn[disabled]{opacity:.6;cursor:not-allowed;transform:none}

        .note{margin-top:8px;font-size:12px;color:var(--muted)}
        .flash{padding:10px 12px;margin:10px 0;border:1px solid #bfdbfe;background:#eff6ff;color:#1e3a8a;border-radius:10px;font-size:13px}
    </style>
</head>
<body>
<!--<div class="wrap" th:with="fixedEmail=${fixedAdminEmail != null ? fixedAdminEmail : 'admin@gmail.com'}">-->

    <p class="breadcrumb"><a th:href="@{/admin/accounts}">← Back to list</a></p>

    <div class="page-head">
        <div>
            <h1 class="title">Account detail</h1>
            <p class="subtitle">Thông tin người dùng & thao tác quản trị.</p>
        </div>
    </div>

    <div class="grid">

        <!-- LEFT: Info -->
        <section class="card">
            <div class="card-head"><h3 class="card-title">Thông tin tài khoản</h3></div>
            <div class="card-body">
                <dl class="dl">
                    <dt>ID</dt>
                    <dd class="mono" th:text="${acc.accountId}">1</dd>

                    <dt>Email</dt>
                    <dd class="mono" th:text="${acc.email}">email@example.com</dd>

                    <dt>Full name</dt>
                    <dd th:text="${acc.fullName} ?: '—'">Name</dd>

                    <dt>Phone</dt>
                    <dd th:text="${#strings.isEmpty(acc.phone) ? '—' : acc.phone}">—</dd>

                    <dt>Address</dt>
                    <dd th:text="${#strings.isEmpty(acc.address) ? '—' : acc.address}">—</dd>

                    <dt>Role</dt>
                    <dd>
                        <span th:if="${acc.role != null}" class="badge" th:text="${acc.role.roleName}">ROLE</span>
                        <span th:if="${acc.role == null}" class="muted">N/A</span>
                    </dd>

                    <dt>Status</dt>
                    <dd>
            <span th:class="'badge ' + (${acc.status?.name()} == 'ACTIVE' ? 'status-active' : 'status-deactivated')"
                  th:text="${acc.status != null ? acc.status.name() : 'N/A'}">ACTIVE</span>
                    </dd>

                    <dt>Verified</dt>
                    <dd>
                        <span th:if="${acc.verified}" class="badge verify">Verified</span>
                        <span th:if="${!acc.verified}" class="muted">Not verified</span>
                    </dd>

                    <dt>Created</dt>
                    <dd th:text="${acc.createdAt != null ? #temporals.format(acc.createdAt,'dd/MM/yyyy HH:mm') : '—'}">—</dd>

                    <dt>Updated</dt>
                    <dd th:text="${acc.updatedAt != null ? #temporals.format(acc.updatedAt,'dd/MM/yyyy HH:mm') : '—'}">—</dd>
                </dl>
            </div>
        </section>
        <aside class="card">
            <div class="card-head"><h3 class="card-title">Thao tác</h3></div>
            <div class="card-body">
                <div th:if="${roles != null}">
                    <p class="muted" style="margin:0 0 6px">Đổi vai trò</p>
                    <form class="form-row" th:action="@{|/admin/accounts/${acc.accountId}/role|}" method="post">
                        <div th:if="${_csrf != null}">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        </div>
                        <select name="role"
                                th:disabled="${#strings.equalsIgnoreCase(acc.email, fixedEmail)}" required>
                            <option th:each="r : ${roles}"
                                    th:value="${r}"
                                    th:text="${r}"
                                    th:selected="${acc.role != null and acc.role.roleName == r}"
                                    th:attr="disabled=${r.name() == 'ADMIN' and !#strings.equalsIgnoreCase(acc.email, fixedEmail)}">
                            </option>
                        </select>
                        <button class="btn success" type="submit"
                                th:disabled="${#strings.equalsIgnoreCase(acc.email, fixedEmail)}">Update</button>
                    </form>
                    <p class="note" th:if="${#strings.equalsIgnoreCase(acc.email, fixedEmail)}">
                        Đây là tài khoản ADMIN cố định. Không thể đổi vai trò.
                    </p>
                    <hr style="border:none;border-top:1px solid var(--border);margin:16px 0">
                </div>

                <!-- View orders or more actions (placeholder) -->
                <a class="btn primary block" th:href="@{|/admin/accounts/${acc.accountId}|}">Refresh</a>

                <!-- Delete -->
                <form style="margin-top:10px"
                      th:action="@{|/admin/accounts/${acc.accountId}/delete|}"
                      method="post"
                      onsubmit="return confirm('Delete this account?');">
                    <div th:if="${_csrf != null}">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    </div>
                    <button class="btn danger block" type="submit"
                            th:disabled="${#strings.equalsIgnoreCase(acc.email, fixedEmail)}">
                        Delete account
                    </button>
                </form>
                <p class="note" th:if="${#strings.equalsIgnoreCase(acc.email, fixedEmail)}">
                    Không thể xóa tài khoản ADMIN cố định.
                </p>

            </div>
        </aside>

    </div>

</div>
</body>
</html>
