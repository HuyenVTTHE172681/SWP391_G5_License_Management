<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Admin • Accounts</title>
    <style>
        :root{
            /* Light palette */
            --bg:#f5f7fb;            /* nền page sáng */
            --card:#ffffff;          /* nền card trắng */
            --muted:#64748b;         /* chữ phụ */
            --text:#0f172a;          /* chữ chính */
            --border:#e2e8f0;        /* viền nhạt */
            --accent:#2563eb;        /* xanh dương */
            --accent-2:#16a34a;      /* xanh lá */
            --warn:#dc2626;          /* đỏ cảnh báo */
            --hover:#f1f5f9;         /* hover hàng */
        }

        *{ box-sizing:border-box }
        html,body{ height:100% }

        body{
            margin:0;
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
            background:
                    radial-gradient(1200px 600px at 20% -10%, #c7d2fe33, transparent 60%),
                    radial-gradient(1000px 500px at 110% 10%, #bbf7d033, transparent 60%),
                    var(--bg);
            color:var(--text);
            padding:28px;
        }

        /* Layout */
        .wrap{ max-width:1100px; margin:0 auto }
        .page-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:18px }

        /* Title: bỏ gradient để dễ đọc hơn */
        .title{
            margin:0;
            font-weight:800;
            letter-spacing:.2px;
            line-height:1.1;
            font-size: clamp(26px, 3vw, 32px);
            color: var(--text);
            text-shadow: 0 1px 2px rgba(15,23,42,.06);
        }
        .subtitle{ margin:6px 0 0; color:var(--muted); font-size:13px }

        /* Card sáng */
        .card{
            background: linear-gradient(180deg, #ffffff, #fbfdff);
            border:1px solid var(--border);
            border-radius:14px;
            box-shadow: 0 10px 24px rgba(2,6,23,.08);
            overflow:hidden;
        }
        .card-head{
            display:flex; align-items:center; justify-content:space-between;
            padding:14px 16px; border-bottom:1px solid var(--border)
        }
        .card-title{ font-weight:600; margin:0; font-size:15px }

        /* Thông báo “flash” sáng & thân thiện */
        .flash{
            padding:10px 12px; margin:10px 0;
            border:1px solid #86efac; background:#ecfdf5; color:#166534;
            border-radius:10px; font-size:13px
        }

        /* Table */
        .table-wrap{ overflow:auto }
        table{ border-collapse:collapse; width:100%; min-width:880px }
        thead th{
            position:sticky; top:0; background:#ffffff;         /* sticky header sáng */
            border-bottom:1px solid var(--border);
            color:#334155; font-weight:700; text-align:left;
            font-size:12px; letter-spacing:.3px; text-transform:uppercase
        }
        th,td{ padding:12px 14px; border-bottom:1px solid var(--border) }
        tbody tr:hover{ background:var(--hover) }
        td.small{ color:var(--muted); font-size:13px }

        /* Badges (sáng, có tương phản) */
        .badge{
            display:inline-block; padding:3px 8px; border-radius:999px; font-size:12px;
            border:1px solid #c7d2fe; background:#eef2ff; color:#1e3a8a;
        }
        .badge.role{ background:#e0e7ff }
        .badge.status-active{ background:#ecfdf5; color:#166534; border-color:#86efac }
        .badge.status-deactivated{ background:#fee2e2; color:#991b1b; border-color:#fecaca }

        /* Buttons (nhẹ nhàng, rõ ràng) */
        .btn{
            appearance:none;
            border:1px solid var(--border);
            background:#f8fafc;
            color:var(--text);
            padding:8px 12px;
            border-radius:10px;
            cursor:pointer; text-decoration:none; font-size:13px;
            transition: transform .05s ease, background .2s ease, border-color .2s ease;
            margin-right:6px;
        }
        .btn:hover{ background:#eef2ff; transform:translateY(-1px) }

        .btn.view{ border-color:#bfdbfe; background:#eff6ff; color:#1e40af }
        .btn.view:hover{ background:#dbeafe }

        .btn.update{ border-color:#86efac; background:#ecfdf5; color:#166534 }
        .btn.update:hover{ background:#dcfce7 }

        .btn.delete{ border-color:#fecaca; background:#fff1f2; color:#9f1239 }
        .btn.delete:hover{ background:#ffe4e6 }

        /* Select (sáng + focus ring rõ ràng) */
        select, button{ font:inherit }
        select{
            background:#ffffff; color:var(--text);
            border:1px solid var(--border); border-radius:8px; padding:7px 10px; min-width:130px;
        }
        select:focus-visible, .btn:focus-visible{
            outline:2px solid var(--accent); outline-offset:2px;
        }

        /* Empty state */
        .empty{
            padding:22px; border:1px dashed var(--border); border-radius:12px;
            color:var(--muted); text-align:center; background:#ffffff80
        }


        .actions{ display:flex; align-items:center; gap:8px; flex-wrap:wrap }
    </style>

</head>
<body>
<div class="wrap">

    <div class="page-head">
        <div>
            <h1 class="title">Accounts</h1>
            <p class="subtitle">Quản lý tài khoản: xem, đổi vai trò, và xoá.</p>
        </div>
    </div>

    <p th:if="${msg}" class="flash" th:text="${msg}">Message</p>

    <div th:if="${#lists.isEmpty(accounts)}" class="empty">No accounts.</div>

    <div th:if="${!#lists.isEmpty(accounts)}" class="card">
        <div class="card-head">
            <h3 class="card-title">Account List</h3>
        </div>

        <div class="table-wrap">
            <table>
                <thead>
                <tr>
                    <th style="width:90px">ID</th>
                    <th>Email</th>
                    <th>Full name</th>
                    <th style="width:140px">Role</th>
                    <th style="width:260px">Change role</th>
                    <th style="width:230px">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="a : ${accounts}">
                    <td class="small" th:text="${a.accountId}">1</td>

                    <!-- Email hiển thị text -->
                    <td th:text="${a.email}">email@example.com</td>

                    <td th:text="${a.fullName}">Name</td>

                    <!-- Role hiện tại (badge) -->
                    <td>
                        <span th:if="${a.role != null}" class="badge role" th:text="${a.role.roleName}">ROLE</span>
                        <span th:if="${a.role == null}" class="badge">N/A</span>
                    </td>

                    <!-- Đổi role -->
                    <td>
                        <form class="inline" th:action="@{|/admin/accounts/${a.accountId}/role|}" method="post">
                            <div th:if="${_csrf != null}">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            </div>
                            <select name="role" required>
                                <option th:each="r : ${roles}"
                                        th:value="${r}"
                                        th:text="${r}"
                                        th:selected="${a.role != null and a.role.roleName == r}">
                                </option>
                            </select>
                            <button class="btn update" type="submit">Update</button>
                        </form>
                    </td>

                    <!-- Actions -->
                    <td>
                        <a class="btn view" th:href="@{|/admin/accounts/${a.accountId}|}">View</a>
                        <button class="btn delete" type="submit">Delete</button>

                        <form class="inline"
                              th:action="@{|/admin/accounts/${a.accountId}/delete|}"
                              method="post"
                              onsubmit="return confirm('Delete this account?');">
                            <div th:if="${_csrf != null}">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                            </div>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>
</body>
</html>
