<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Package</title>
    <link rel="stylesheet" th:href="@{/css/package.css}">
    <script>
        function validateEdit(event) {
            const name = document.getElementById("packageName").value.trim();
            const duration = parseInt(document.getElementById("durationInMonths").value);
            const price = parseFloat(document.getElementById("price").value);
            const desc = document.getElementById("description").value.trim();

            let errors = [];

            if (name === "" || name.length > 100)
                errors.push("⚠ Package name cannot be blank and must be ≤ 100 characters.");
            if (isNaN(duration) || duration < 1 || duration > 60)
                errors.push("⚠ Duration must be between 1 and 60 months.");
            if (isNaN(price) || price <= 0 || price > 10000000)
                errors.push("⚠ Price must be between 0.01 and 10,000,000.");
            if (desc.length > 255)
                errors.push("⚠ Description must not exceed 255 characters.");

            if (errors.length > 0) {
                alert(errors.join("\n"));
                event.preventDefault();
            }
        }
    </script>
</head>
<body>
<div class="container">
    <h1>Edit Package</h1>

    <form th:action="@{'/manager/package/edit/' + ${sellerPackage.id}}"
          method="post"
          class="form-box"
          onsubmit="validateEdit(event)" th:object="${sellerPackage}">
        <input type="hidden" name="status" th:value="${sellerPackage.status}">
        <label>Package Name:</label>
        <input type="text" th:field="*{packageName}">
        <p th:errors="*{packageName}" style="color: red"></p>

        <label>Duration (months):</label>
        <input type="number"
               min="1" max="60" th:field="*{durationInMonths}">
        <p th:errors="*{durationInMonths}" style="color: red"></p>


        <label>Price ($):</label>
        <input type="number"
               step="0.01" min="0.01" max="10000000" th:field="*{price}">
        <p th:errors="*{price}" style="color: red"></p>

        <label>Description:</label>
        <textarea
                th:field="*{description}"></textarea>
        <p th:errors="*{description}" style="color: red"></p>

        <button type="submit" class="btn btn-save">Update</button>
        <a th:href="@{/manager/package/list}" class="btn btn-back">Back</a>
    </form>
</div>
</body>
</html>
